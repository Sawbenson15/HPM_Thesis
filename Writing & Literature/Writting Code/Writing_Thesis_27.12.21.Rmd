---
title: An Emperical Economic Investigation into COVID-19's Impact on Fundemental Hedonic
  Features in Real Estate Valuation Models Using Machine Learning Methods
author: "Sawyer M. Benson"
date: "December 21, 2021"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document: default
  html_notebook: default
bibliography: library.bib
link-citations: yes
---

<br><br>

### Check List

* Label tables and graphics
* Make relationship to Louisiana clear
* Use one person (I, or me, or we)
* Check section numbering
* Spell check
* Use same term for corona the whole way through
* Check for plagiarism 
* Make video explaining thesis for prof. grading

<br><br>

### Cover Page

Under construction

<br>

### Abstract
Under construction

The purpose of this thesis is to understand the economic impact the Covid-19 crisis had on housing prices and how these impacts changed the relative demand of homeowners for certain hedonic features of a home. To determine which variables would be important to analyze, an *eXtreme Gradient Boost* (XGBoost) machine learning algorithm was trained on a large (i.e. $104\times24412$) dataset of hedonic features from Louisiana, USA market data. An analysis of the XGBoost's variable-importance ranking shows that number of bedrooms, city centrality, total living area, age, and days on the market were among the top most important variables in determine a homes market price. Therefore, a deeper dive into how the crisis impacted the relative demand for these features is critically important in understanding the bigger picture of Covid-19's impact on the housing market.

A panel of analysis shows that Covid-19, measured by the daily 3-month moving average of official infections at the time of sale, significantly increased average home prices by *8.97 USD* per additional daily infection. This finding establishes the corona-specific reaction of housing market prices to daily infections. When analyzing how this price shift is explained by specific demand for certain property characteristics, I find: the premiums for each level of number of bedrooms is significantly increased in response to daily infections, with an average increase of *32, 37, 27, and 47 USD* per additional daily infection for levels 2-through-5 bedrooms respectively; the premimum for being central to a city increased by *5.17 USD* per daily infection while properties located outside the city were not significantly impacted by daily infections; premiums for home size increased by *0.02 USD* per daily infection, with the premium for the smallest homes being significantly decreased by *3.15 USD* per daily infection; premiums for property age, which are historically negative, decreased even further with the penalty for each additional year of age increasing by *0.06 USD* per daily infections with the oldest homes experiencing the largest loss of *2.75 USD* per daily infection, per year of age and; an increase in the penalty for each additional day a home sits on the market of *0.04 USD* per daily infection with homes sitting the longest period of time on the market experiencing the largest loss of *2.75* per daily infection, per day.

<br>

###     Table of Contents

1. **Introduction**
2. **Literature Review**
3. **Data**
4. **Methodology**
5. **Results**
6. **Discussion**
7. **Conclusion**
8. **Bibliography**
9. **Appendix**

<br>

### Figures, Tables, and Abbreviations
Under construction

<br><br>

### 1. Introduction

In late 2019, a virus first detected in Wuhan, China would set in motion a global pandemic which, by the end of 2021, will have killed 4.3 million people, infecting 238 million others, and disrupting the global economy across virtually every measurable dimension [@WHODeath]. According to seven economic impact models constructed by @McKibbin, estimates of the total global economic loss in terms of GDP are measured to be as large as 9.2 trillion USD. However, despite a generally positive correlation between GDP and real estate prices (see figure 1), historically measured as high as 98%, real estate market prices in the US hit near-record heights following the outbreak of COVID-19 [@AsiaGreen]. According to a report released by Zillow Analytics [@Manhertz], U.S. real estate gained 2.5 trillion dollars of value in 2020 alone, representing the largest single-year growth since 2005, despite an approximately 760 billion dollar decrease in GDP in the same year [@FRED2021]. The focus of this thesis is to investigate the reasons behind why and how real estate market prices have broken trend and behaved so uncharacteristically counter cyclical in the face of a global pandemic.

<br>

***Figure 1***
<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/GDP_Housing_Nominal.png){width=70%}
</center>

<br>

In the following sections, I will apply the Hedonic Pricing Method (HPM) to Louisiana housing market data in order to inferentially describe the economic impact of the global pandemic on residential housing market values. Furthermore, I will take advantage of the HPM's structural framework of using real estate properties' hedonic features (e.g., size, age, number of bedrooms, etc.) to test for changes in demand for specific property features pre vs post pandemic. The HPM will be econometrically modeled using an Ordinary Least Squares (OLS) regressions framework for specific variable analysis while several variations of machine learning (ML) prediction models will be estimated to test different independent variables' maximum explanatory power in predicting out-of-sample observations. The results of these models will shed light into the otherwise counter intuitive response of real estate pricing dynamics to the COVID-19 global pandemic.    

<br><br>

### 2. Literature Review

#### 2.1 Background

The market value of a commodity is most often theoretically defined as the equilibrium price derived from the basic economic principal, or law, of supply and demand [@Locke; @Epple]. However, the real estate market often violates this assumption due to its unique characteristics as an asset class [@Wheaton]. For example, much of the underlying utility of a property is its use as a means of shelter by its owner [@Ling]. This rather unusual relationship to this asset introduces several behavioral biases which cause economic frictions not accounted for by traditional neoclassical economic theory [@Nicolaides]. A notable example of behavioral bias impacting real estate price dynamics is the endowment effect. This behavioral finding was originally established by @Kahneman in the late 20th century, and later applied to real estate markets by @BAO. The latter of the two stating that the predictably irrational behavior of market participants to overvalue their home due to sentimental attachment to the property forces market prices into sustained economic disequilibrium. Other highly cited and unusual characteristics are that real estate assets are very infrequently traded due to high transaction costs [@Collett; @Guilkey], governments tend to interfere, both directly and indirectly with real estate markets through the creation of fiscal and monetary policies [@Bingyang; @Du], and through creating renter-protections laws such as 'squatter's rights' laws which allow a renter to remain in a home for extended periods of time long after they have stopped paying rent [@Hoy; @Gardiner].

#### 2.2 Real Estate Valuation Methods

The idiosyncratic asset features outlined in section 2.1 along with a high level of heterogeneity across many dimensions of the entire real estate asset class makes the creation of a generalized pricing model difficult and have led to a wide range of proposals and recommendations about what determines the market price of real estate assets and how to reliably model those pricing dynamics [@Curcuru]. In @Pagourtzi, the authors outlines several of the currently accepted real estate valuation methods, ranging from what they categorize as the *traditional methods*, such as comparable-group, cost, income-multiple, profit-multiple, and contractorâ€™s method, to the *advanced methods*, such as ANNs, spatial analysis methods, fuzzy logic, and the hedonic pricing method. According to a meta analysis conducted by @Sirmans, currently, the most widely used and accepted advanced methodological framework for real estate valuation modeling is the Hedonic Pricing Method.


##### 2.2.1 Hedonic Prcing Model in Real Estate

First applied in 1939 on automobile data, according to @Goodman, the HPM is a model which estimates the value of distinct characteristics of a commodity which directly or indirectly contribute to its market value. Besides its implementation in real estate finance and economics, such as in this thesis, this methodology has a wide range of applications such as its implementation in consumer and market research [@Holbrook; @Arnold], construction of consumer price indices [@Moulton; @Schultze], various tax assessments [@Berry; @Bernasconi], automated automobile valuation [@Crowling; @Matas], and computer sales [@Dulberger; @Wakefield].

Since its introduction, the HPM has gain significant popularity among housing market and commercial real estate researchers. The specific real estate-based topics include, but are not limited to, the construction of housing price indices [@Gourieroux; @Wallace], the estimation and prediction of a property's market value in situations where market-transaction data is low-dimensional or non-existent [@LeSage], and, as in this thesis, the specific analysis of changes in the demand for specific property characteristics across time, subgroups, or both [@Clapp]. As the broad search for a satisfactory modeling framework focuses in on the HPM, another debate arises regarding the best functional form of this method. Traditionally utilizing the standard OLS framework [@Pace], researchers are increasingly utilizing a variety machine learning algorithms to accomplish an increasingly more refined set of findings.

##### 2.2.2 OLS and the Hedonic Pricing Model in Real Estate
Unsurprisingly, regression analysis is the preferred estimation approach among real estate researchers when using HPT for price estimation. These multiple regression analysis methods are most often either an Ordinary Least Squares (OLS) regression or a Maximum Likelihood approximation of the log-likely equation derived directly from the hedonic function. Each of these estimation methods take a functionally similar path as they both estimate a vector of parameters (i.e. beta coefficients) that best fits the explanatory hedonic variables to the associated market price. They differ only by the loss function used in the identification of that best-fitted parameter vector.

The most commonly used hedonic price regression equation with respect to real estate markets models the relationship between market rents or market property values to a list of hedonic characteristics. The classical construction of this model according to **(Herath, S. K. & Maier, G. (2010))** is the following:

$$
R = f(P,N,L,t)
$$
where $R$ is rent or price of the property; $P$ is property related attributes; $N$ is neighborhood characteristics; $L$ is locational variables and; $t$ is an indicator of time.

##### 2.2.3 Machine Learning and the Hedonic Pricing Model in Real Estate

Though first introduced by @Turing under the broader umbrella term of *artificial intelligence*, the adoption of ML methods in real estate would take many years of software and hardware development, allowing or the subsequent collection of ever-growing data sets and central processing unites (CPUs) capable of processing the often extraordinary number of calculation required to produce a solution for a given algorithm [@Dutta]. The primary advantage of ML techniques are that ML algorithms learn and improve over time and across many iterations and variable combinations, while tradition statistical and econometric techniques produce static results across a single model [@Anguita]. The algorithm improves across those iterations as it seeks to minimize the model's error in predicting observations not previously seen, often called *out of sample* observations. By doing this, the algorithm seeks to find the strongest general relationship between the independent variables and the dependent variable instead of seeking to minimize the error within a given sample set. This in tern results in stronger, more generalized interpretation of the findings.    
 
@Mohd provides a thorough overview of the various applications of ML to real estate valuation methods, including the Ridge, Lasso regression techniques as well as artificial neural networks (ANN) and gradient boosting techniques used in this thesis. The author concludes that ML models out perform other standard valuation methods such as multiples and OLS valuation methods in both accuracy and strength of interpretation. The best performing of these models was a gradient boosting model, which was able to capture the often hidden layers of interaction between hedonic features.

<br>

#### 2.3 COVID-19 Crisis' Impact on Real Estate Markets

In the wake of the COVID-19 crisis, there were several papers and articles regarding the economic impact of the global pandemic on the housing market being expeditiously publishes in virtually every major journal. These papers investigate topics such as structural and temporal changes in the housing market using hedonic methods [@Shimizu], changes in housing market demand for specific property types and features [@Tajani], potential changes in housing preferences due to the COVID-19 pandemic and highlight the challenges for policy making [@Nanda]. Each of these papers result in findings which establish a statistically significant impact of COVID-19 on relative demand for certain hedonic features in each respective real estate market. Later in this thesis, I will establish a similar finding in the Louisiana housing market.

<br><br>

### 3. Data 
#### 3.1 Data Collection

The utilization of Big Data collected through a data-mining process called *web-scrapping* has increasingly become the method of choice for researchers across disciplines. The term web-scrapping simply refers to the process of collecting structured data from websites using algorithms to automate the collection process. Methods similar to ones I have implemented in this thesis have been used by established authors such as **Borde et al., PÃ©rez-Rave et al. and Berawi et al.** 

In this thesis, I have used a mixture of the programming languages R and Python, supplemented by several packages created by Selenium, to write an algorithm that collects the required hedonic variables for this research from the Multiple Listing Services (MLS). **Table 1** is a summary of the original data set's key features.

#### 3.2 Data Processing

Though the data-collecting algorithms return structured data, it is nevertheless far from being suitable for the rather picky
models which will eventually analyze them. Therefore, the following processes were completed in order to render the raw data
into a usable form:

1. **Missing values** (i.e. N/A values) were removed 
2. **Outliers** were identified and removed for all continuous variables
   + An 'outlier' is defined by being more than 1.5 standard deviations from the mean of the variable's own distribution
3. **Multilevel factor** data was broken out by each level into binary representations through *Hot-One* coding
   + Some features which had a large number of factor levels were simplified using Lasso regressive methods
4. **High-leverage** point observations, according to diagnostic linear regression, were removed
5. **Duplicates**, defined by the MLS unique identification number, were removed
6. **Structural errors** (e.g. dates structured as string variable) were corrected
7. **Binary variables** were created for key variables (e.g. city_limits) by the following standard method:

$$
I\left(y\right)=\left\{\begin{array}{ll}1,\quad x\in A\\0, \quad x \notin A\end{array}\right.,
$$
Where $I$ is an indicator function with space $A$ that composes dummy variable $x$ into $1$ if the condition is met and into $0$ if it is not.

<br>

***Table 1***
<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Data Collectioin/Data_table_1.png){width=40%}
</center>

<br>

The results of the data cleaning processes cane be seen in **table 2**.

<br>

***Table 2***
<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Data Collectioin/Data_table_2.png){width=60%}
</center>

<br>

#### 3.3 Variable List
A list and short discription of all variables used in this thesis can be found in ***Table 3***

<br>

***Table 3***
<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Data Collectioin/Var_list_com.png){width=100%}
</center>

<br>


<br><br>

#### 3.3 Data Distriptive Statistics
##### 3.3.1 Correlation 
The correlation matrix (see ***Image 2***) between all numeric variables shows that with exception to the variables which will have obvious correlations (e.g. sold_price and list_price, area_total and area_living, and infections figures), there are no other correlations which would cause concern.

<br>

***Image 2***
<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/correlation_matrix.png){width=80%}
</center>

<br>

##### 3.3.2 Distributions of Select Variables
As the standard descriptive characteristics of a particular variable are considered (i.e. measures of frequency, central tendency, dispersion, and position), the matrix of density plots below (see ***Image 3***) give us a good overview of the most relevant variables in this data set. 

<br>

***Image 3***
<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Select_var_summary.png){width=100%}
</center>

##### 3.3.3 Price Index
To understand the general shape and historical trend of the pricing market specifically within Louisiana, I have constructed a simple weighted-average price per sqft. index (see ***Image 4***) using 1, 2, 3, and 4 month-moving averages of the entire data set. Furthermore, I show the St. Louis Federal Reserve's GDP (*green*) and price index (*purple*) for the Louisiana housing market (see ***Image 5***. Though the methods used in both indecies are not the same, which accounts for the general level differences between the two, one can see the shape of the data is fitting to the population.   

<br>

***Image 4***
<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/index_la.png){width=90%}
</center>

<br>
<br>

***Image 5***
<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/gdp_la.png){width=90%}
</center>

<br><br>

### 4. Methodology
The overarching method used in this thesis is the Hedonic Pricing Method (HPM), also often referred to as hedonic regression or hedonic demand theory. The fundamental theory behind the HPM is the following: commodities are distinguishable by their component parts, therefore, the market value of a given commodity can be calculated by summing the estimated values of its separate characteristics. For this theory to hold true, several critical requirement must be met. Primarily, that the commodity being valued can be reduced down to it's component parts and that the market is able to implicitly and independently value these characteristics. The fulfillment of these requirements are not obvious and in reality will in some measure fall short of accounting for the complete nature of price dynamics in practically every asset class. However, this limitation offers an interesting problem to test. Namely, to find the limit of the accumulated power of these component parts to account for market values and their deviations across time and subgroups. This exact questions will be later examined by implementing a machine-learned predictive model to measure the theoretical maximum explanatory power of the included hedonic variables. In the following two subsections, we review the methods used in this paper to econometrically model the HPM on hedonic real estate data.

<br>

#### 4.1 Multi-Variable Linear Regression 
In this section, I will outline the construction of my base OLS model, termed the Alpha model, as well as the treatment process for heteroskadasticity, multicolinearity, non-linearity, and high-leverage points and outliers.  

##### 4.1.1 Basic Model Design

Following the OLS construction laid out by @Herath1:

$$
R = f(P,N,L,t)
$$
where $R$ is rent or price of the property; $P$ is property related attributes; $N$ is neighborhood characteristics; $L$ is locational variables and; $t$ is an indicator of time.

This paper's base OLS model, named the Alpha model, is as follows:

$$
{P}_{n\times1} = \ A_{n\times1} \ + \  B_{k\times1}{V}_{n\times k} \ +  \ \mathcal{E}_{n\times1}
$$

where $P$ is a ${n\times1}$ vector of sold prices; $A$ is a ${n\times1}$ vector of the model's intercepts; $B$ is a ${k\times1}$ vector of beta coefficients; $V$ is a ${n\times k}$ matrix of all hedonic variables; $\mathcal{E}$ is a ${n\times1}$ vector of the model's random error; subscript $n$ is the number of observations and; $k$ is the length of the variable list.

<br>

##### 4.1.2 Accounting for Heteroscadasticity
A Breusch-Pagan test was conducted on a standard linear regression model with sold price as the dependent variable and the rest of the dataset as regressors. The Breusch-Pagan (BP) test was established as a method in 1979 and follows the logic set by the Lagrange multiplier test principle [@Breusch]. This test tests the null hypothesis that the variance in the model's errors is independent from model's regressors (i.e. heteroscadasticity). The test's results in a rejections of the null hypothesis, thereby finding the base model to be heteroskedastic. The results of this test are summarized in *table x*.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Data Collectioin/bp_test.png){width=50%}
</center>

<br>

To resolve the heteroskadasticity found in Â§3.4.1, I will produce heteroskedasticity-consistent (HC) standard errors, also known as heteroskedasticity-robust standard errors, through the refined method established by econometrician Halbert Lynn White [@White].This process is as follows:

If the model's errors $u_{i}$ are independent, but have distinct variances $\sigma _{i}^{2}$ then $\Sigma =\operatorname{diag}(\sigma _{1}^{2},\ldots ,\sigma _{n}^{2})$ which can be estimated with ${\displaystyle {\widehat {\sigma }}_{i}^{2}={\widehat {u}}_{i}^{2}}$. This relationship produces the estimator found in @White:

<br>

$$ {\displaystyle {\begin{aligned}v_{\text{HCE}}\left[{\widehat {\beta }}_{\text{OLS}}\right]&={\frac {1}{n}}\left({\frac {1}{n}}\sum _{i}X_{i}X_{i}'\right)^{-1}\left({\frac {1}{n}}\sum _{i}X_{i}X_{i}'{\widehat {u}}_{i}^{2}\right)\left({\frac {1}{n}}\sum _{i}X_{i}X_{i}'\right)^{-1}\end{aligned}}}$$
$${\displaystyle {\begin{aligned}&=(\mathbb {X} '\mathbb {X} )^{-1}(\mathbb {X} '\operatorname {diag} ({\widehat {u}}_{1}^{2},\ldots ,{\widehat {u}}_{n}^{2})\mathbb {X} )(\mathbb {X} '\mathbb {X} )^{-1},\end{aligned}}}$$

<br>

where $\mathbb{X}$ denotes the matrix of stacked $X_i'$ values from the data. The estimator can be derived in terms of the generalized method of moments (GMM).

For the remainder of this thesis, all statements and figures regarding statistical significance will be referring to tests conducted with heteroskedasticity-consistent (HC) standard errors. As sample errors in my models will have equal variance and are uncorrelated, the least-squares estimates of each model's beta coefficients are regarded as Best Linear Unbiased Estimators (BLUEs).

<br>

##### 4.1.3 Accounting for Multicolinearity
Multicolinearity is measured using Variance Inflation Factors (VIF). The VIF of a predictor measures how accurately that variable can be predicted using all other variables. For context, the square root of a VIF represents the increase in standard error of the estimated coefficient with respect to the case when that given variable is independent of all other variables. Inline with current convention, all variables with a VIF larger than 5 are eliminated. A graphical representation of all variable multicolinearity, measured by VIF, is shown in image x.

This test resulted in the elimination of the variables ***list_price*** and ***area_total*** and there were highly multicolinear with ***sold_price*** and ***area_living*** respectively.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Multi_colin/Multi_co_combined.png){width=80%}
</center>

<br>

##### 4.1.4 Accounting for Non-linearities
I visual analysis was conducted on all continuous variables and non-linear variables transformation were added to ***age*** and ***area_living***

*Age:*

An analysis of age vs. sold price shows a well-established u-shaped pattern. In order to allow the OLS model to better capture this relationship, a new variable $age^2$ is added to the model. 

Image x shows the Partial Dependency Plot (PDP) of age within the Alpha model. This plots the marginal prediction of the Alpha model across the full range of age. When the scale of the y-axis is reduced, we see the slight curvature in Alpha model's estimation of age effects. This addition improved $R^2$ by $.08$. 

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Nonlinearities/age_non_lin_com.png){width=100%}
</center>

<br>

*Living Area:*

An analysis of living-area vs. sold price reveals a Sigmoid pattern between the two variables. In order to allow the OLS model to better capture this relationship, a new variable $living \ area^2$ is added to the model. 

Image x shows the Partial Dependency Plot (PDP) of $living \ area^2$ within the Alpha model. This addition improved $R^2$ by $.06$.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Nonlinearities/living_area_non_lin_com.png){width=100%}
</center>

<br>

##### 4.1.5 Accounting for High-Leverage Points and Outliers
After the adjustments or the previous sections have been made, a panel of visualizations are run on the Alpha model. The results show no extreme outliers and only one high-leverage point (obs #23515), as shows by the residual vs. leverage plot in quadrant two of image X, which is removed in the final Alpha model. These results are mainly due to the previous removal of outliers in Â§3.2 and the overall quality of the data set. 

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/alpha_plots.png){width=70%}
</center>

<br>

##### 4.1.6 Final Alpha Model
Under Construction

The Alpha model is the baseline OLS for this thesis and is rebust to heteroskadasticity, multicolinearity, non-linearities, high-leverage points and outliers. These high-level adjustment increase our confidence in the statistical tests results which follow  

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Alpha_model_final.png){width=70%}
</center>

<br>

#### 4.3 Modeling Changes in Demand for Hedonic Features
The focus of this thesis is how the Covid crisis impacted housing prices and the relative levels of demand for specific hedonic features. In the case where the HPM is in the OLS functional form, the beta coefficients of this model represent relative demand for each associated hedonic feature [@Shimizu]. For example, $\beta_{pool = 1} =11,856$ is interpreted as the average consumer's willingness to pay for an average pool, ceteris parabus. However, this thesis wishes to measure the *changes* in the average consumer's willingness to pay for a given feature (e.g. pool) in relationship a measurement of Covid's economic impact. 

##### 4.3.1 Comparison Method
A method of statistically comparing changes in the beta coefficients of particular features of interest under multiple scenarios (e.g. post and pre-corona period) is needed. To accomplish this, a method outlined by the UCLA Statistics department is implemented [@Bruin]. The best way to understand this method is to see a simplest reproducible example.

Suppose we want to test the economic impact of Corona on the relative demand for swimming pools, $\beta_{pool = 1}$ and $pool$ respectively. Using the UCLA method, we test the null hypothesis $H_0:\beta_{pool = 1,\ corona = 0} = \beta_{pool = 1,\ corona = 1}$ with the following OLS

<br>

$$
{sold \ price} = \alpha \ + \beta_1 {pool} \ + \  \beta_2 {corona} \ + \beta_3 {(pool \times corona)}
$$
<br>

Which results in the following:

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/UCLA_output_1.png){width=50%}
</center>

<br>

The interpretation of this simplified model's estimates are:

* Intercept: Intercept for $pool = 0$ 
   + The omited group
* pool: Slope for $pool = 1$
   + The included group
* infections period: $($Intercept $infections \ period = 1)$ $-$ $($intercept $infections \ period = 0)$
   + This can be seen by running individual regressions for each case
* (pool*infections period): Slope for $pool_{infections \ period = 1}$ $-$ $pool_{infections \ period = 0}$ 
   + This estimate tests the null hypothesis $H_0: \beta_{pool = 1,\ corona = 0} = \beta_{pool = 1,\ corona = 1}$

<br>

Therefore, we say:

> The average premium for a property having a **swimming pool** fell by **$7,766.40** when compared to pre-corona levels, ceteris parabus. However, this finding is only significant at the ***p < 0.10*** level.  

<br>

##### 4.3.2 Selecting a Corona Measurment
A good measurement variable for measuring the response of the market to the corona crisis must be a corona-related matric which is publicly available; common knowledge to the population and; is a reasonable measurement of future economic shifts. For this reason, data collected from the Louisiana Department of Health [@LaDH] was used to calculate the 3-month moving average of corona infections (infections_3mma).

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Corona_General/Waves_of_infection.png){width=70%}
</center>

<br>

This measurement fulfills the previously stated requirements of a good test measurement as it is purely related to the corona crisis, is publicly available, is assumed to be publicly known as it is reported across all major news stations daily, and perhaps most importantly, is the primary metric used to decide when mandatory lockdowns are instituted. For this thesis, it is assume the market is responding to some lagged value of daily infections which are being used by consumers to estimate the likelihood of future lockdowns and the stringency, and duration of current lockdowns. With this rational, infections_3mma is selected as the primary measurement of corona's impact. 

<br><br>

#### 4.4 Machine Learning 

##### 4.4.1 Machine Learning Methods

In the previous subsection 4.1, it was stated that the multivariable regression models estimate a vector of parameters (i.e. beta coefficients) that best fit the explanatory hedonic variables to the associated dependent variable. Intuitively, the resulting fitted coefficient vector is fitted to the entire data set, and therefore, the loss function minimizes the error in the model's ability to *explain* the very independent variable it was fitted to. In other terms, these results are ultimately limited to their inferential value within the exact context of the data set the model is trained on. If one is to establish a wider, more general relationship between dependent and independent variables that go beyond the context of the trained data set, supervised machine learning (ML) prediction models are an extremely powerful tool to do so. Though the models used in this thesis differ across several key processes, they each generally follow a similar logic: 

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/ML_Process_2.png){width=70%}
</center>

<br>

##### 4.4.2 Model Evaluation with Cross-Validation

In order to rank order models, we perform a process called Cross-Validation (CV). First, the full data set must be split into 'test' and 'train' (i.e. validation) subsets. Each ML model will be fitted to the train data set and it's performance will be evaluated based the model's ability to predicted out-of-sample observations in the test (validation) data set. In this way, these models are ranked based on their test mean squared errors (MSE). This process is often referred to as Cross Validation (CV). The two most commonly used CV methods are the Validation Set Approach and K-Fold Cross Validation. 

The Validation Set Approach (VSA) is the simplest case of cross validation data splitting as it randomly splits the entire data set into train and test subsets based on a certain percentage split. For example, the researcher can choose to split the data set with a 80% training and 20% testing split. The estimation for the test MSE is simply the test error against the test data set.

<br>

<center> *Test MSE Estimation Equation* </center>

$$CV_{vsa} = MSE_{vsa}$$

<br>

<center>

![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Val_Set.png){width=50%}
</center>

<br>

The K-Fold CV method has increasingly been used by researches as it offers a more comprehensive cross validation process when compared to other methods. K-Fold CV is the process of randomly splitting the entire data set into k groups, or folds, each with approximately an equal number of observations. The first fold is held out and the model is trained on the remaining k-1 folds. This process is repeated k times, each time holding out a different fold until every fold has been treated as the validation set. Finally, this will results in k estimations of the model's test error and the final estimation will be the average across all k model fits. 

<br>

<center> *Test MSE Estimation Equation* </center>

$$CV_{k-fold} = \frac{1}{k}\sum_{t=1}^{k} MSE_i$$

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/K_Fold.png){width=50%}
</center>

<br>

##### 4.4.4 ML Model Selection 
For this thesis, ML models will be ranked based on two features: Accuracy, as measured by test MSE, and interpretability, qualitatively defined by the model's ability to provide insights into to which features are relevant to the ability to make correct predictions, and by how much are they relevant.

*Accuracy*

Since a method of model fitting and evaluation has been established in the previous section through the process of Cross Validation, we now have a way to rank different models to each other based on their ability to estimate test MSE. With this feature, it is possible to compare several models to one another in terms of effectiveness in predictions. Five different ML models were build for this thesis with the following results:

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Data Collectioin/ml_results.png){width=40%}
</center>

<br>

*Interpretability*

A major criticism of ML models are their lack of interpretabilty, explaining *how* the model makes such accurate predictions. A prime example of this critique can be seen in Artificial Neural Networks (ANN) machines, which often use a large number of small nodes to sequentially generate a single prediction without any one of these nodes holding a clear interpretation as to which variables, or combination of variables, lead to a particular improvement in prediction. However, as ML methods become more commonly used, the demand for interpretation of these models has driven several useful interpretation methods across for a variety of models. These methods include interpretation for a single prediction, such as the Local Interpretable Model-agnostic Explanations (LIME), as well as generalized methods of measuring relative feature importance, which uses various techniques to determine the average contribution of each variable to the model's ability to decrease its test MSE rate. 


Of the models sampled, the eXtreme Gradient Boosting Machine, also referred to as XGBoost, outperforms the other models both in terms of having the lowest test MSE and having the best methods for detailed variable interpretation. For this reason, XGBoost is chosen as the primary ML model for this thesis 


<br>

##### 4.4.5 eXtreme Gradient Boosting Machine Algorithm
In order to understand the logic of XGBoost, one must first look at the compact, yet powerful algorithm behind its computation. In this section, I will lay out the mathematical formulation of the input, core algorithm, and final output of the XGBoost machine.

<br>

1. Algorithm input: We start with a training set ${\displaystyle \{(x_{i},y_{i})\}_{i=1}^{N}}$, a differentiable loss function $L(y, F(x))$, a number of weak learners (shallow trees) $M$, and a learning rate $\alpha$.


2. Algorithm:

2.1 Initialize model with a constant value:

$${\displaystyle {\hat {f}}_{(0)}(x)={\underset {\theta }{\arg \min }}\sum _{i=1}^{N}L(y_{i},\theta )}$$

<br>

2.2 For $m = 1$ to $M$:

2.2.1 Compute the 'gradients' and 'hessians
$${\displaystyle {\hat {g}}_{m}(x_{i})=\left[{\frac {\partial L(y_{i},f(x_{i}))}{\partial f(x_{i})}}\right]_{f(x)={\hat {f}}_{(m-1)}(x)}}$$
$${\displaystyle {\hat {h}}_{m}(x_{i})=\left[{\frac {\partial ^{2}L(y_{i},f(x_{i}))}{\partial f(x_{i})^{2}}}\right]_{f(x)={\hat {f}}_{(m-1)}(x)}}$$

<br>

2.2.2 Fit an original weak learner (e.g. shallow tree) using the training set ${\displaystyle \displaystyle \{x_{i},-{\frac {{\hat {g}}_{m}(x_{i})}{{\hat {h}}_{m}(x_{i})}}\}_{i=1}^{N}}$ by solving the following optimization problem:

$${\displaystyle {\hat {\phi }}_{m}={\underset {\phi \in \mathbf {\Phi } }{\arg \min }}\sum _{i=1}^{N}{\frac {1}{2}}{\hat {h}}_{m}(x_{i})\left[-{\frac {{\hat {g}}_{m}(x_{i})}{{\hat {h}}_{m}(x_{i})}}-\phi (x_{i})\right]^{2}}$$

$${\displaystyle {\hat {f}}_{m}(x)=\alpha {\hat {\phi }}_{m}(x).}$$

<br>

2.3 Update the model:
$${\displaystyle {\hat {f}}_{(m)}(x)={\hat {f}}_{(m-1)}(x)+{\hat {f}}_{m}(x).}$$

<br>

3. Algorithm Output: 
$${\displaystyle {\hat {f}}(x)={\hat {f}}_{(M)}(x)=\sum _{m=0}^{M}{\hat {f}}_{m}(x)}$$

<br>

##### 4.4.6 XGBoost Model Fitting and Hyperparameter Tuning
In practice, when attempting to produce the most optimal results from an XGBoost machine, as is true with most other ML models, one must first transform the data set into an optimal form and then run set of hyperparameter tests to determine the appropriate level for each of the model's basic structural rules (i.e. hyperparameters).

Since the XGBoost machine requires only numerical data, factor data must be converted into numerical levels which can be the used in the construction of decision trees. To accomplish this with the added complexity of some factor variables having more than two levels, I have used a method called *One-Hot Encoding*, which encodes each individual factor variable level into a vector containing '1' if that factor and level are present, and '0' if it is not. In this way, the dataframe is converted into a large matrix of continuous and binary columns.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/One_hot_table.png){width=90%}
</center>

<br>

Once the model is fitted to the data, the next procedure is to tune the hyperparameters which govern the algorithm's learning process and therefore determine the resulting values of estimated parameters. To do this, a large grid of hyperparameters is created and then an individual model containing each unique combination of hyperparameter levels is generated and their resulting test MSE's are ranked and analyzed. The results from this large grid search determine which combination of hyperparameters are optimal, and those hyperparameters are used in the final model. The search grid from this research was so large, it took my computer *78 hours* to complete all of the calculation necessary for the full tuning process.

<br>

##### 4.4.7 XGBoost Partial Dependency Plots

Partial dependency plots (PDP) shows relationship, or dependence, between the model's response variable (i.e. $sold \ price$) and a chosen variable, or set of variables, of interests (VoI), resulting in the graphical representation of a variables marginal contribution to the machine's prediction across the variable of interest's entire range. In order to analyze the results of the XGBoost machine at the variable-by-variable level, I have generate a panel of four graphical partial dependency plots for each variable of interest. Thesis will be the following: Basic PDP plot, Individual Conditional Expectation (ICE) plots, PDP heatmap with VoI against corona infection, 3-dimensional PDP heatmap with VoI against corona infection. An example of each of these graphs, using days on market as the variable of focus, can be seen in quadrants IV, I, III, and II respectively.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/PDP_Example_Combined.png){width=99%}
</center>

<br>

<br><br>

### 5. Hypothesis Construction

#### 5.1 Covid-19: General Case
> **Hypothesis I:** The Covid-19 crisis significantly increased housing prices
>
> **Reasoning:** As many workers have perminantly shifted to remote work, the total utility of residential housing has increased, thereby increasing the price households are willing to pay. This price shift can be explained through measuring the changes if relative demand for specific hedonic features, such as bedrooms, size, age, and others. 

<br>

#### 5.2 Covid-19: Premium for Bedrooms
> **Hypothesis II:** The Covid-19 crisis significantly increased demand-premiums for every level of number of bedrooms greater than 1 
>
> **Reasoning:** As many workers have perminantly shifted to remote work, the premium for an additional bedroom is expected to increase across each level of total number of bedrooms as households need additional rooms for homeoffices and other activities. The premium for a single bedroom is expected to be insignificant since there are no recorded 0-bedroom houses to upgrade from.

<br>

#### 5.3 Covid-19: Premium for City Centrality
> **Hypothesis III:** The Covid-19 crisis impacted properties within city limits more than those not within city limits  
>
> **Reasoning:** As workers who live in city limits are expected to hold jobs more likely to be compateble with remote work, such as jobs within the financial industry, home prices within city limits are disproporsionatly impacted by the shift to remote work.

<br>

#### 5.4 Covid-19: Premium for Size

> **Hypothesis IV:** The Covid-19 crisis increased the premium for property size 
>
> **Reasoning:** Same as for hypothesis I

<br>

> **Hypothesis V:** The Covid-19 crisis impacted properties in the top 25th percentile of property size more than the bottom 25th percentile 
>
> **Reasoning:** Households who live in the top 25th percentile of home sizes are more likely to hold white-collar jobs, which are more likely to be made remote, which increases the premium they are willing to pay for additonal hedonic features.

<br>

#### 5.5 Covid-19: Premium for Age 

> **Hypothesis VI:** The Covid-19 crisis decreased the premium for property age 
>
> **Reasoning:** As the volocity of home sales increase, the general relationship between property age and price is expected to be exasterbated as those upgrading houses will shit towards newer properties

<br>

> **Hypothesis VII:** The Covid-19 crisis impacted properties in the top 25th percentile of age more than the bottom 25th percentile  
>
> **Reasoning:** The premium for the youngest (i.e. newest) properties is expected to increase while the premium for the oldest properties is expected to decrease. As the market shifts towards newer properties, they must necissarily shift away from older properties.

<br>

#### 5.6 Covid-19: Change in Days on Market

> **Hypothesis VIII:** The Covid-19 crisis significantly decreased the premium for days on market 
>
> **Reasoning:** As the volocity of home sales increase, more homes are sold faster, and therefore the number of days on the market becomes less of a predictor of quality since even lower quality and over-priced homes are sold more quickly. 

<br>

> **Hypothesis IX:** The Covid-19 crisis impacted properties in the top 25th percentile of days on market more than the bottom 25th percentile 
>
> **Reasoning:** The premium for a property being sold within the top 25th percentile of days on market (DOM), i.e. the properties which sit on the market the logest, is expected to be disproportionately effected when compared homes which sold the fastest, as households elasticity of demand for specific characteristics decreses relative to price, it will take larger deviation in price and quality to make a home sell in the top 25th percentile of DOM 


<br><br>

### 6. Results
This section will follow a consistent structure for each set of results. Each hypothesis will have: A *summary of the finding*; *feature review* of the characteristic being modeled; and *model results* from the OLS and ML models with standard hypothesis conclusion(s). 

<br>

#### 6.1 Covid-19: General Case
##### 6.1.1 Summary of Findings

> Preliminary analysis of housing prices and daily infections reveals a positive historical relationship between these two key variables. This relationship is strongly supported by the XGBoost ML algorithm, which shows that a maximal reduction in predictions error is acheived by increasing prediciton price at all levels of daily infections greater than 0, holding all other factors constant. XGBoost also determined that from the 104 total variables used, daily infections is the 19th most important variable in reducing price prediction error.  
>
> In the fully controlled Alpha model, the beta coefficient for daily infections suggests that each additional infection is associated with an average home price *increase of $8.97*, ceteris parabus. This finding is significant at the *p < 0.00* level. Therefore, we reject $H_0: beta_{infections_3mma} = 0$. I conclude that the Covid-19 crisis significantly increased housing prices Hypothesis I).

##### 6.1.2 Visual Review
We first look at the distribution of daily infections and the accumulation of infections across time. The variation in historical daily infections should provide a strong measurement for explaining variations in price related to this key variable. 

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Corona_General/Infections_combined.png){width=99%}
</center>

<br>

To investigate the raw historical relationship between infections rates and prices, we look at the trend line of price vs daily infections (rhs) and a comparison between the price distributions of pre and post-infections period (lhs). These analysis suggests a historically positive relationship between infections and price. Though these graphs are promising, it is unclear if other factors could be influencing this relationship. To establish a statistical relationship, we turn to the following OLS and ML models.  

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Corona_General/Infect_price_combo.png){width=99%}
</center>

<br>

##### 6.1.3 OLS Modeling
Since displaying the full OLS output for every set of results is impractical, I will include a summarized version with only the key variables included. Please note that if you wish to see each regression output table, code, and data associated with this thesis, you can visit my public GitHub repository with the following link: https://github.com/Sawbenson15/HPM_Thesis.

> In the fully controlled Alpha model, the beta coefficient for daily infections suggest that each additional infection is associated with an average home price *increase of $8.97*, ceteris parabus. This finding is significant at the *p < 0.00* level. I therefore reject the $H_0$ of Hypothesis I, concluding that the Covid-19 crisis significantly increased housing prices.   

This foundational finding lays the groundwork for the following results, which attempt to explain the significant relationship between infections and price at the level of individual hedonic variables.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Corona_General/summary_OLS.png){width=40%}
</center>

<br><br>

The following graphic shows the historical relationship between daily infections and sold price with a 1SD error margin at all point (in grey), the best single-variable fit (in green), and the Alpha model's marginal fit (in blue). We see that the many controls of the Alpha model flatten the estimated marginal effect of each additional daily infection on price, however, this relationshiip remains positive and significant, as previously established.  

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Corona_General/Corona_price_OLSFit.png){width=55%}
</center>

<br>

##### 6.1.4 ML Modeling
To further test the relevance of corona infections in determining prices, we look at this variable's relative ranking based it's ability to improve out-of-sample predictions within our XGboost model. The measurement used is called Variable Importance and is defined by a combination of gain, cover, and frequency. Gain is how much prediction power is gained when the variable is added to the model; cover is how heavily the variable is weighted in each iteration, and frequency is how frequently the variable appears across all iterations. 

We see that of the 104 unique variables offered to the XGBoost machine, the 3-month moving average of infection was the 19th most descriptive variable in predicting prices. I consider this results non-trivial and a very strong confirmation that the relationship found in the OLS model is correct. 

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Corona_General/Var_Importance.png){width=90%}
</center>

To get a detailed understanding of the marginal effect each additional daily infection has on price through, we look at the PDP and the ICE of infections and price. The PDP (top) shows the optimal price change w.r.t. daily infections which minimize the model's test MSE. The ICE (bottom) is the individual PDP for every observation in the dataset, centered at infection = 0. The ICE allows us to understand the simple PDP, which is an everage of the individual ICEs, in more detail and also to pick up on any signs of heteroskedasticity among the individual sample predictions. 

The PDP shows that on average, an increase in price at every level of daily infections > 0 reduces test MSE. Furthermore, this trend is generally upward trending, with a notable range of response between 1,800 and 2,500 infections, which I refer to as the *infection-price ridge.* Discussions regarding possible explanations for the general shape of this region will be explored in section 7.     

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Corona_General/PDP_ICE_general.png){width=80%}
</center>

<br>

#### 6.2 Covid-19: Premium for Bedrooms
*Foreword for this section:*

There are two contextual details which must be considered for one to appropriately interpret the following findings. First, the variables for total number bedrooms and the total living area of a home are highly correlated, and therefore when total living area is included in the OLS model, the beta coefficients for each level of number of bedrooms represents the premium homeowners are willing to pay for the actual feature of an extra bedroom at a fixed living area, and not the extra living area itself. As this results in convoluted results, living area is excluded when testing the effect of bedrooms. This effectively measures the additional room and the average additional living area associated with that additional room at each level (e.g. from 1 bedroom to 2, 2 to 3, etc.). Secondly, the OLS results listed below represent the change in the premiums (i.e. beta coefficients) from post vs. pre corona and not the absolute price premiums, as in the case of measuring daily infection alone. 

##### 6.2.1 Summary of Findings

Note: add xgboost results

> Prelimilary findings show that the price distribution for every level of number of bedrooms increased after the beginning of the infection period (i.e. accumulation of infections >= 1000), as predicted. The average number of total bedrooms between pre and post-infections period deviate slightly, with post-infections period being 0.003 higher. However, the key focus of this section is not absolute changes in the feature *number of bedrooms*, but rather in the change in premium for each level of number of bedrooms.    
>
> The fully controled Alpha model results show that the everage premium for each level of number of bedrooms significantly increased in response to increases in daily infections. Every increase found is at least significant at the p < 0.05 level except for single bedroom homes. Therefore, I reject the $H_0:$ of hypothesis II and conclude that the Covid-19 crisis significantly increased demand-premiums for every level of number of bedrooms greater than 1. It should also be noted to the premium increase is increasing larger for at each level, suggesting that the premium for the 4th bedroom in a home increased more than the premium for the 3rd bedroom. Possible theories regarding this significant shift in premiums is explored in section 7.


##### 6.2.2 Visual Review
General distribution of number of bedrooms per residential property.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Beds/bed_dist_gen.png){width=70%}
</center>

<br>

Distributions of prices at each level of number of bedrooms (lhs) and the distributions of prices at each level of number of bedrooms split by before and after infection period (rhs).

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Beds/bed_combined.png){width=100%}
</center>

<br>

It is also instructive to look at the same two plots above, but normalized by square footage. We see a significant flattening between each level of number of bedrooms, however, a distinct change from pre vs. post infection period is still visible (rhs). The next section will test if this shift from post to pre-corona is significantly in general, and significantly related to daily infections.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Beds/bed_ppsf_combined.png){width=100%}
</center>

<br>

##### 6.2.3 OLS Modeling
Under the fully controlled Alpha model, we see that corona-driven premiums changes at ever level of number of bedrooms is statistically significant except for single-bedroom properties. This finding suggest that for every additional 3-month-moving-average daily infection present at the time the property is sold is associated with an average increase of 25, 32, 37, 27, and 47 USD for levels 2-through-5 respectively.      

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Beds/OLS_Output.png){width=50%}
</center>

<br>

##### 6.2.4 ML Modeling
Due to number of bedrooms being categorical, the results of the XGBoost model for these variables are not as easily visually represented as continuous variables, which have an easier interpretation through PDPs. However, we can consider the results in written form and with adjusted graphs to represent the importance rankings. 

The variable importance ranking of each factor level from 1-through-5 bedrooms is 84, 60, 47, 34, and 68 respectively from the total 104 variables used in the model. This relatively low relevance is expected, as much of the explanatory power of bedrooms on price is taken by total living area, ranked number 1 in the importance matrix. However, we see that test MSE is minimized by increasing price at each level of number of bedrooms.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Beds/beds_importance.png){width=60%}
</center>

<br>

#### 6.3 Covid-19: Premium for City Centrality
*Foreword for this section:*

In this section, it is important to note that a property being within city limits does not mean that it should be viewed as being in the center of a major city. This categorization is better understood as a distinction from properties which are rural, such as properties on farm land and heavily wooded or otherwise remote areas. It should also be noted that results at several levels of analysis will be discussed, such as nonimal differences in the populations, price reactions to daily infections for each sub-population, and the change in premium for being within city limits.    


##### 6.3.1 Summary of Findings
> Preliminary analysis of city centrality's impact on home prices shows that homes within city limits have a higher price on average when compared to rural properties. Further visual analysis suggests that prices grew in both sub-populations post vs. pre-infection period, with city-cintral properties experincing the larger nominal shift in average prices. The XGBoost model shows that an increase in prediction price when a property is within city limits maximally reduces the model's test MSE, sugesting this variable is a generally important feature, with a ranking of 42 in the importance matrix.  
>
> In the fully controlled Alpha model, the coefficient for daily infections and city limits suggests that each additional infection is associated with an average *increase of $5.17* in the premium for being located within city limits compared to property not within city limits, ceteris parabus. This finding is significant at the *p < 0.00* level. Therefore, I reject the $H_0:$ of hypothesis III and conclude that the Covid-19 crisis impacted properties within city limits more than those not within city limits.

##### 6.3.2 Visual Review
<br>

To better understand the effect corona had on properties specifically located within city limits, I split the city_limits distribution by infection periods. This separation shows a clear increase in association with the infections period.  
<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/City/dist_city_com.png){width=100%}
</center>

<br>

##### 6.3.3 OLS Modeling
First, we look at the main result which tests the change in premium for being within city limits, in constrast to rural properties, before vs. after infection period. This finding shows each additional infection is associated with an average city_limts premium *increase of $5.17* compared to property not within city limits, ceteris parabus. This finding is significant at the *p < 0.00* level.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/City/OLS.png){width=50%}
</center>

<br>

To further highlight the differences in corona's impact of properties within city limits vs outside of city limits, I ran a separate regression model for each sub-population with all of the standard controls of the Alpha model to see the impact of daily infections on prices. This results shows that properties within city limits (lhs) have an average increase of $9.15 per additional daily infection which is significant at the *p < 0.00* level, while the model for rural properties (rhs) shows that daily infections is not a significant variable in explaining variations in prices. It should also be noted how much smaller the number of observations is in the rural model.   

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/City/OLS_com.png){width=100%}
</center>

<br>


##### 6.3.4 ML Modeling
<br>
The XGBoost PDP of the city_limits dummy variable shows that increasing property value when the property is within city limits maximally reduces test MSE. 

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/City/City_PDP.png){width=50%}
</center>

<br>

#### 6.4 Covid-19: Premium for Size
##### 6.4.1 Summary of Findings
> An analysis of size shows that this feature is smoothly distributed across the data set with the average total living area marginally higher in the post-infections period. The XGBoost model rankes this feature as the number one most impartant variable in predicting prices. 
>
> In the fully controlled Alpha model, the coefficient for daily infections and total living area suggests that each additional infection is associated with an average premium *increase of $0.02* for total living area, measured per square foot, ceteris parabus. This finding is significant at the *p < 0.00* level. Therefore, I reject the $H_0:$ of hypothesis IV and conclude that the Covid-19 crisis increased the premium for property size.
>
> Furthermore, I have run a separate Alpha model for the top and bottom 25th percentile of total living area. These results show that the premium for the smallest homes decreases per additional daily infection (-3.15 USD, p < 0.00), while homes in the top 25th percentile increase with respect to daily infections (-3.15 USD, p < 0.00). This suggests a shift away from smaller homes and towards larger homes in response to the corona crisis. Therefore, I reject the $H_0:$ of hypothesis V and conclude that the Covid-19 crisis impacted properties in the top 25th percentile of property size more than the bottom 25th

##### 6.4.2 Visual Review
Total living area is relatively smoothly distributed across the data set with the average total living area marginally higher in the post-infections period. Since this feature is roughly stable in the short run, this result is expected.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Living_area/area_dist_total_com.png){width=100%}
</center>

<br>

Price distribution, however, differ between pre and post-infection period when normalized by per square foot (sqft.).
<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Living_area/area_dist_price_coronaa.png){width=70%}
</center>

<br>

##### 6.4.3 OLS Modeling
The fully controlled Alpha model shows the coefficient for daily infections and total living area suggests that each additional infection is associated with an average premium *increase of $0.02* for total living area, measured per square foot, ceteris parabus. This finding is significant at the *p < 0.00* level.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Living_area/area_total.png){width=50%}
</center>

<br>

To further test this relationship, I have run a separate Alpha model for the top and bottom 25th percentile of total living area. These results show that the premium for the smallest homes decreases per additional daily infection (-3.15 USD, p < 0.00), while homes in the top 25th percentile increase with respect to daily infections (-3.15 USD, p < 0.00). This suggests a shift away from smaller homes and towards larger homes in response to the corona crisis.
<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Living_area/Screen Shot 2022-02-06 at 18.36.46.png){width=100%}
</center>

<br>

##### 6.4.4 ML Modeling
The PDP and ICE plots show a stable and consistant increase in prices as total living area increases.
<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Living_area/area_PDP.png){width=90%}
</center>

<br>

The heatmaps of predicted price with respect to daily infections and total living area show that both variables consistently increase XGBoost's price predictions, with the Maximal Price Region (MPR) at the top 25th percentile of both variables.
<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Living_area/area_heat_com.png){width=100%}
</center>

<br>

#### 6.5 Covid-19: Premium for Age 
##### 6.5.1 Summary of Findings
> A preliminary analysis of age shows that this feature is different in the pre and post-infections periods, with the lower average age of homes sold in the post-infection period suggesting that home owners prefere, on average, newer homes. The XGBoost model rankes this feature as the second most impartant variable in predicting prices. 
>
> In the fully controlled Alpha model, the coefficient for daily infections and age suggests that each additional daily infection is associated with an average premium *decrease of $0.06* for each aditional year of age, ceteris parabus. This result can be interpreted as an increase in the penilty per additonal year of age, making older home even more undisirable post-infections period. This finding is significant at the *p < 0.00* level. Therefore, I reject the $H_0:$ of *hypothesis VI* and conclude that The Covid-19 crisis decreased the premium for property age.
>
> Furthermore, I have run a separate Alpha model for the top and bottom 25th percentile of age. These results show that the premium for the oldest homes decreases per additional daily infection (-2.75 USD, p < 0.00), while the premium for being in the bottom 25th percentile of age (i.e. newest homes) is not significantly different pre vs post-infection period. This suggests a distinct shift away from older homes in response to the corona crisis. Therefore, I reject the $H_0:$ of *hypothesis VII* and conclude that the Covid-19 crisis impacted properties in the top 25th percentile of property age more than the bottom 25th.


##### 6.5.2 Visual Review
The graph below highlights the differences in the age distributions between the pre and post infections period groups. We see a decrease in the average age in homes sold in the post-infection period.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Age/age_dists_com.png){width=90%}
</center>

<br>

##### 6.5.3 OLS Modeling
Alpha model, finds that each additional daily infection is associated with an average premium *decrease of $0.06* for each additional year of age, ceteris parabus. This result can be interpreted as an increase in the penalty per additional year of age, making older home even more undesirable in the post-infections period. This finding is significant at the *p < 0.00* level.

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Age/age_gen.png){width=50%}
</center>

<br>

Two separate Alpha models for the top and bottom 25th percentile of age show that the premium for the oldest homes *decreases* per additional daily infection (-2.75 USD, p < 0.00), while the premium for being in the bottom 25th percentile of age (i.e. newest homes) is *not significantly different* pre vs post-infection period. This suggests that home owners shifted distictly away from older homes more than towards newer homes.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Age/age_ols_com.png){width=100%}
</center>

<br>

##### 6.5.4 ML Modeling
The XGBoost model's PDP and ICE plots show the expected convexed shape between age and price predictions with an inflection point at approximatly 65 years. Since the vast majority of properties sold in my time sample are between the ages of 0 and 55 years old (94%), the downward relationship between age and price prediciton is most relivent for this paper.   

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Age/age_PDP.png){width=100%}
</center>

<br>

To better understand the marginal impact of age and daily infections on predicted home prices, we turn to the heat maps below. It can be seen that the highest marginal price additions happen in the region: 0 < age < 10 and 1800 < infections < 2300. 

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Age/age_heat_com.png){width=100%}
</center>

<br>

#### 6.6 Covid-19: Change in Days on Market
*Foreword for this section:*

Days on market (DOM) is a strange variable as it is relationship to the final selling price of a home is not unidirectional. This is because the number of days a home sits on the market is greatly determined by the relationship between the original listing price and the actual market value of the home, with over-priced homes taking longer to sell and under-priced homes less time. However, it is also the case that people will to wait for the right buyer to come along will be rewarded by selling their home at a higher price. This feedback loop makes standard econometric interpretations difficult and the folloiwng results in this section should be analyzed with this fact in mind. 

##### 6.6.1 Summary of Findings
> A preliminary analysis of DOM shows that this feature noticably shifted in the post-infection period, with the average DOM being lower when campaired to the pre-infections period. Of the 104 variables used to train the XGBoost model, DOM is ranked as the 8th most impartant variable in predicting prices. 
>
> In the fully controlled Alpha model, the coefficient for daily infections and DOM suggests that each additional daily infection is associated with an average premium *decrease of $0.04* for each aditional day a property sits on the market before being sold, ceteris parabus. This result can be interpreted as an increase in the penilty per additonal day on the market. This finding is significant at the *p < 0.00* level. Therefore, I reject the $H_0:$ of *hypothesis VIII* and conclude that the Covid-19 crisis significantly decreased the premium for days on market
>
> Furthermore, I have run a separate Alpha model for the top and bottom 25th percentile of DOM. These results show that the negative premium for the homes which sat on the market the longest decreased (-2.75 USD, p < 0.00), while the premium for being in the bottom 25th percentile (i.e. homes sold the fastest) is not significantly different pre vs post-infection period. Therefore, I reject the $H_0:$ of *hypothesis IX* and conclude that the Covid-19 crisis impacted properties in the top 25th percentile of property age more than the bottom 25th.


##### 6.6.2 Visual Review
<br>
The preliminary graphical analysis of DOM shows a clear average decrease of DOM for homes sold in the post-infection period.

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Dom/dom_dist_com.png){width=100%}
</center>

<br>

##### 6.6.3 OLS Modeling
Alpha model, the interaction coefficient for daily infections and DOM suggests that each additional daily infection is associated with an average premium *decrease of $0.04* for each additional day a property sits on the market before being sold, ceteris parabus. This result can be interpreted as an increase in the penalty per additonal day on the market. This finding is significant at the *p < 0.00* level. 

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Dom/dom_gen.png){width=50%}
</center>

<br>
Separate Alpha models for the top and bottom 25th percentile of DOM. These results show that the negative premium for the homes which sat on the market the longest decreased (-2.75 USD, p < 0.00), while the premium for being in the bottom 25th percentile (i.e. homes sold the fastest) is not significantly different pre vs post-infection period.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Dom/dom_com.png){width=100%}
</center>

<br>

##### 6.6.4 ML Modeling
PDP and ICE graphs show a sharp initial decrease in prediction prices ad then a consistent downward trend. The end behavior at the top of DOM is explained by a small number of observation at the extreme and can therefore be ignored.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Dom/dom_PDP.png){width=70%}
</center>

<br>
The heatmaps for DOM and daily infections show that properties sold at approximately 0 DOM and within the infection-price ridge are predicted to have the highest price.

<br>

<center>
![](/Users/sawyerbenson/Documents/Master Thesis/HPM_Thesis/Writing & Literature/Graphics from pptx/Results/Dom/dom_heat_com.png){width=100%}
</center>

<br>

#### 6.7 Summary of Results and Hypothesis 

##### 6.7.1 Covid-19: General Case
> **Hypothesis I:** The Covid-19 crisis significantly increased housing prices
>
> **Results:**

<br>

##### 6.7.2 Covid-19: Premium for Bedrooms
> **Hypothesis II:** The Covid-19 crisis significantly increased demand-premiums for every level of number of bedrooms greater than 1 
>
> **Results:**

<br>

##### 6.7.3 Covid-19: Premium for City Centrality
> **Hypothesis III:** The Covid-19 crisis impacted properties within city limits more than those not within city limits  
>
> **Results:**

<br>

##### 6.7.4 Covid-19: Premium for Size

> **Hypothesis IV:** The Covid-19 crisis increased the premium for property size 
>
> **Results:**

<br>

> **Hypothesis V:** The Covid-19 crisis impacted properties in the top 25th percentile of property size more than the bottom 25th percentile 
>
> **Results:**

<br>

##### 6.7.5 Covid-19: Premium for Age 

> **Hypothesis VI:** The Covid-19 crisis decreased the premium for property age 
>
> **Results:**

<br>

> **Hypothesis VII:** The Covid-19 crisis impacted properties in the top 25th percentile of age more than the bottom 25th percentile  
>
> **Results:**

<br>

##### 6.7.6 Covid-19: Change in Days on Market

> **Hypothesis VIII:** The Covid-19 crisis significantly decreased the premium for days on market 
>
> **Results:** 

<br>

> **Hypothesis IX:** The Covid-19 crisis impacted properties in the top 25th percentile of days on market more than the bottom 25th percentile 
>
> **Results:**

<br><br>

### 7. Discussion
Under construction

Note: Provide an outlook of the future developments of the particular scientific discussion, discuss policy implications and point out open questions.

<br><br>

### 8. Conclusion
Under construction

The purpose of this thesis is to understand the economic impact the Covid-19 crisis had on housing prices and how these impacts changed the relative demand of homeowners for certain hedonic features of a home using Louisiana, USA market data. To determine which variables would be important to analyze, an *eXtreme Gradient Boost* (XGBoost) machine learning algorithm was trained on a large (i.e. $104\times24412$) dataset of hedonic features. An analysis of the XGBoost's variable-importance ranking shows that number of bedrooms, city centrality, total living area, age, and days on the market were among the top most important variables in determine a homes market price. Therefore, a deeper dive into how the crisis impacted the relative demand for these features is critically important in understanding the bigger picture of Covid-19's impact on the housing market.

A panel of analysis shows that Covid-19, measured by the daily 3-month moving average of official infections at the time of sale, significantly increased average home prices by *8.97 USD* per additional daily infection. This finding establishes the corona-specific reaction of housing market prices to daily infections. When analyzing how this price shift is explained by specific demand for certain property characteristics, I find: the premiums for each level of number of bedrooms is significantly increased in response to daily infections, with an average increase of *32, 37, 27, and 47 USD* per additional daily infection for levels 2-through-5 bedrooms respectively; the premimum for being central to a city increased by *5.17 USD* per daily infection while properties located outside the city were not significantly impacted by daily infections; premiums for home size increased by *0.02 USD* per daily infection, with the premium for the smallest homes being significantly decreased by *3.15 USD* per daily infection; premiums for property age, which are historically negative, decreased even further with the penalty for each additional year of age increasing by *0.06 USD* per daily infections with the oldest homes experiencing the largest loss of *2.75 USD* per daily infection, per year of age and; an increase in the penalty for each additional day a home sits on the market of *0.04 USD* per daily infection with homes sitting the longest period of time on the market experiencing the largest loss of *2.75* per daily infection, per day.

These findings describe the ideal home to own during the crisis is a newly built, 3,000 sqft. of living area, 5-bedroom house centrally located to the nearest city which is sold in 0 days once made publicly available for sale.



What methods I used to get results
results
conclusion of those results
Connection
Call to action



<br><br>

### 9. Bibliography

<br><br>

### 9. Appendix

<br><br>

<br><br><br>

End of Document


